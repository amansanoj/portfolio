<!-- Konami Code Easter Egg: â†‘ â†‘ â†“ â†“ â† â†’ â† â†’ B A -->
<div id="easter-egg" aria-hidden="true" role="dialog" aria-label="Secret terminal">
	<div id="ee-terminal">
		<div id="ee-titlebar">
			<span class="ee-dot ee-red"></span>
			<span class="ee-dot ee-yellow"></span>
			<span class="ee-dot ee-green"></span>
			<span class="ee-title">aman@chaya ~ zsh</span>
			<button id="ee-close" aria-label="Close terminal">âœ•</button>
		</div>
		<div id="ee-body">
			<pre id="ee-output"></pre>
		</div>
	</div>
</div>

<style>
	#easter-egg {
		position: fixed;
		inset: 0;
		z-index: 9999;
		background: rgba(0, 0, 0, 0.55);
		display: flex;
		align-items: flex-end;
		justify-content: center;
		opacity: 0;
		pointer-events: none;
		transition: opacity 0.25s ease;
	}
	#easter-egg.open {
		opacity: 1;
		pointer-events: all;
	}
	#ee-terminal {
		width: min(640px, 96vw);
		background: #1a1a1a;
		border-radius: 10px 10px 0 0;
		font-family: 'JetBrains Mono', 'Fira Code', 'Cascadia Code', ui-monospace, monospace;
		font-size: 0.88rem;
		transform: translateY(100%);
		transition: transform 0.35s cubic-bezier(0.4, 0, 0.2, 1);
		box-shadow: 0 -8px 40px rgba(0,0,0,0.5);
		overflow: hidden;
	}
	#easter-egg.open #ee-terminal {
		transform: translateY(0);
	}
	#ee-titlebar {
		display: flex;
		align-items: center;
		gap: 6px;
		padding: 10px 14px;
		background: #2a2a2a;
		border-bottom: 1px solid #333;
		user-select: none;
	}
	.ee-dot {
		width: 12px;
		height: 12px;
		border-radius: 50%;
		display: inline-block;
		flex-shrink: 0;
	}
	.ee-red    { background: #ff5f57; }
	.ee-yellow { background: #febc2e; }
	.ee-green  { background: #28c840; }
	.ee-title {
		flex: 1;
		text-align: center;
		font-size: 0.78rem;
		color: #888;
		margin-left: -54px; /* compensate for close btn to visually centre */
	}
	#ee-close {
		background: none;
		border: none;
		color: #666;
		cursor: pointer;
		font-size: 0.9rem;
		padding: 0 2px;
		transition: color 0.15s;
		line-height: 1;
	}
	#ee-close:hover { color: #ccc; }
	#ee-body {
		padding: 1.2em 1.4em 1.6em;
		min-height: 180px;
		max-height: 60vh;
		overflow-y: auto;
	}
	#ee-output {
		margin: 0;
		white-space: pre-wrap;
		line-height: 1.7;
		color: #c9d1d9;
	}
	#ee-output .prompt  { color: #58a6ff; }
	#ee-output .cmd     { color: #e6edf3; }
	#ee-output .result  { color: #7ee787; }
	#ee-output .muted   { color: #8b949e; }
	#ee-output .accent  { color: #f0883e; }
	#ee-output .cursor  {
		display: inline-block;
		width: 8px;
		height: 1em;
		background: #58a6ff;
		vertical-align: text-bottom;
		animation: blink 1s step-end infinite;
	}
	@keyframes blink {
		50% { opacity: 0; }
	}
</style>

<script>
	const KONAMI = [
		'ArrowUp','ArrowUp','ArrowDown','ArrowDown',
		'ArrowLeft','ArrowRight','ArrowLeft','ArrowRight',
		'b','a'
	];

	const lines: { prompt?: boolean; cmd?: string; result?: string; delay: number }[] = [
		{ prompt: true, cmd: 'whoami',                                       delay: 400  },
		{ result: 'aman sanoj â€” developer, student, certified rat tickler',  delay: 700  },
		{ prompt: true, cmd: 'ls interests/',                                delay: 1300 },
		{ result: 'ai/  web/  formula1/  clean-code/  coffee/',              delay: 1700 },
		{ prompt: true, cmd: 'cat secret.txt',                               delay: 2400 },
		{ result: 'you actually did it. not bad at all.',                    delay: 2800 },
		{ result: '(close with Esc or click outside)',                       delay: 3300 },
	];

	let seq: string[] = [];
	let overlay: HTMLElement | null;
	let closeBtn: HTMLElement | null;
	let output: HTMLElement | null;
	let timeouts: ReturnType<typeof setTimeout>[] = [];
	let opened = false;

	function buildLine(item: typeof lines[number]): string {
		if (item.prompt) {
			return `<span class="prompt">âžœ chaya</span> <span class="cmd">${item.cmd}</span>\n`;
		}
		if (item.result !== undefined) {
			const cls = item.result.startsWith('(') ? 'muted' : 'result';
			return `<span class="${cls}">${item.result}</span>\n`;
		}
		return '';
	}

	function runAnimation() {
		if (!output) return;
		output.innerHTML = '';
		timeouts.forEach(clearTimeout);
		timeouts = [];

		lines.forEach((item) => {
			const t = setTimeout(() => {
				if (!output) return;
				// Remove cursor from previous position
				output.querySelectorAll('.cursor').forEach(c => c.remove());
				output.innerHTML += buildLine(item);
				// Add blinking cursor after last line
				const cursor = document.createElement('span');
				cursor.className = 'cursor';
				output.appendChild(cursor);
			}, item.delay);
			timeouts.push(t);
		});
	}

	function openEgg() {
		if (!overlay) return;
		overlay.classList.add('open');
		overlay.setAttribute('aria-hidden', 'false');
		opened = true;
		runAnimation();
	}

	function closeEgg() {
		if (!overlay) return;
		overlay.classList.remove('open');
		overlay.setAttribute('aria-hidden', 'true');
		opened = false;
		timeouts.forEach(clearTimeout);
	}

	document.addEventListener('DOMContentLoaded', () => {
		overlay  = document.getElementById('easter-egg');
		closeBtn = document.getElementById('ee-close');
		output   = document.getElementById('ee-output');

		// Console hint for curious devs
		console.log(
			'%cðŸ‘€ oh, you\'re a curious one.',
			'color: #58a6ff; font-size: 1.1rem; font-weight: bold;'
		);
		console.log(
			'%ctry the konami code. you know the one.',
			'color: #8b949e; font-size: 0.9rem;'
		);

		closeBtn?.addEventListener('click', closeEgg);

		overlay?.addEventListener('click', (e) => {
			if (e.target === overlay) closeEgg();
		});

		document.addEventListener('keydown', (e) => {
			if (e.key === 'Escape' && opened) { closeEgg(); return; }

			seq.push(e.key);
			if (seq.length > KONAMI.length) seq.shift();
			if (seq.join(',') === KONAMI.join(',')) {
				seq = [];
				openEgg();
			}
		});
	});
</script>
